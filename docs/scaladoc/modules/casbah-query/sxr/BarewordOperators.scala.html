<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>BarewordOperators.scala</title>
        <script type="text/javascript" src="jquery-all.js"></script>
        <script type="text/javascript" src="linked.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/**
 * Copyright (c) 2010 10gen, Inc. &lt;http://10gen.com&gt;
 * Copyright (c) 2009, 2010 Novus Partners, Inc. &lt;http://novus.com&gt;
 * 
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * For questions and comments about this product, please see the project page at:
 *
 *     http://github.com/mongodb/casbah
 * 
 */</span>

<span class="keyword">package</span> com.mongodb.casbah
<span class="keyword">package</span> query

<span class="keyword">import</span> com.mongodb.casbah.commons.<span title="object com.mongodb.casbah.commons.Imports">Imports</span>._
<span class="keyword">import</span> com.mongodb.casbah.commons.Logging

<span class="keyword">import</span> scalaj.collection.<span title="object scalaj.collection.Imports">Imports</span>._

<span class="comment">/** 
 * Base Operator class for Bareword Operators.
 * 
 * Bareword operators stand on their own - they lack the requirement for an LValue.
 * 
 * Operator implementations (see SetOp for an example) should partially apply apply with just their operator name.
 * The apply method's type parameter can be used to restrict the valid RValue values at will.  
 * 
 * 
 * @author Brendan W. McAdams &lt;brendan@10gen.com&gt;
 * @since 1.0
 * @see SetOp
 */</span>
<span class="keyword">trait</span> <a title="trait BarewordQueryOperator extends java.lang.Object with com.mongodb.casbah.commons.Logging with ScalaObject" id="9369">BarewordQueryOperator</a> <span title="ScalaObject" class="keyword">extends</span> <span title="com.mongodb.casbah.commons.Logging">Logging</span> <span class="delimiter">{</span>

  <span class="comment">/*
   * TODO - Implicit filtering of 'valid' (aka convertable) types for [A]
   */</span>
  <span class="keyword">def</span> <a title="[A](oper: String)(fields: (String, A)*)com.mongodb.casbah.commons.Imports.DBObject" id="10057">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="10059">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="10063">oper</a>: <span title="String">String</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="(String, A)*" id="10064">fields</a>: <span title="(String, A)*" class="delimiter">(</span>String, A<span class="delimiter">)</span>*<span class="delimiter">)</span> = <span class="delimiter">{</span> 
    <span class="keyword">val</span> <a title="com.mongodb.casbah.commons.MongoDBObjectBuilder" id="10067">bldr</a> = <span title="=&gt; com.mongodb.casbah.commons.MongoDBObject.type">MongoDBObject</span>.<span title="com.mongodb.casbah.commons.MongoDBObjectBuilder">newBuilder</span>
    <span class="keyword">for</span> <span class="delimiter">(</span><span class="delimiter">(</span><a title="String" id="13291">k</a>, <a title="A" id="13292">v</a><span class="delimiter">)</span> &lt;- <a href="#10064" title="(f: ((String, A)) =&gt; com.mongodb.casbah.commons.MongoDBObjectBuilder)Unit">fields</a><span class="delimiter">)</span> <a href="#10067" title="(x: (String, Any))bldr.type">bldr</a> += <a href="#13291" title="(y: A)(String, A)">k</a> -&gt; <a href="#13292" title="A">v</a>
    <span title="(elems: (String, com.mongodb.casbah.commons.Imports.DBObject)*)com.mongodb.casbah.commons.Imports.DBObject">MongoDBObject</span><span class="delimiter">(</span><a href="#10063" title="(y: com.mongodb.casbah.commons.Imports.DBObject)(String, com.mongodb.casbah.commons.Imports.DBObject)">oper</a> -&gt; <a href="#10067" title="com.mongodb.casbah.commons.MongoDBObjectBuilder">bldr</a>.<span title="implicit com.mongodb.casbah.commons.Implicits.wrapDBObj : (in: com.mongodb.DBObject)com.mongodb.casbah.commons.MongoDBObject">result</span>.<span title="=&gt; com.mongodb.casbah.commons.Imports.DBObject">asDBObject</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>


<span class="comment">/** 
 * Aggregation object for Bareword Operators.
 * Bareword operators stand on their own - they lack the requirement for an LValue.
 * This mixes them in so they can be pulled down in a single import.
 *
 * Typically, you want to follow the model Implicits does, and mix this in
 * if you want to use it but not import Implicits
 *
 * @author Brendan W. McAdams &lt;brendan@10gen.com&gt;
 * @since 1.0
 * @see com.mongodb.casbah.Implicits
 */</span>
<span class="keyword">trait</span> <a title="trait FluidQueryBarewordOps extends java.lang.Object with com.mongodb.casbah.query.SetOp with com.mongodb.casbah.query.UnsetOp with com.mongodb.casbah.query.IncOp with com.mongodb.casbah.query.OrOp with com.mongodb.casbah.query.RenameOp with com.mongodb.casbah.query.ArrayOps with com.mongodb.casbah.query.NorOp" id="9370">FluidQueryBarewordOps</a> <span class="keyword">extends</span> <a href="#9371" title="com.mongodb.casbah.query.SetOp">SetOp</a> 
                               <span class="keyword">with</span> <a href="#9372" title="com.mongodb.casbah.query.UnsetOp">UnsetOp</a>
                               <span class="keyword">with</span> <a href="#9373" title="com.mongodb.casbah.query.IncOp">IncOp</a>
                               <span class="keyword">with</span> <a href="#9381" title="com.mongodb.casbah.query.OrOp">OrOp</a>
                               <span class="keyword">with</span> <a href="#9382" title="com.mongodb.casbah.query.RenameOp">RenameOp</a>
                               <span class="keyword">with</span> <a href="#9374" title="com.mongodb.casbah.query.ArrayOps">ArrayOps</a>
                               <span class="keyword">with</span> <a href="#9383" title="com.mongodb.casbah.query.NorOp">NorOp</a>


<span class="comment">/**
 * Trait to provide the $set (Set) Set method as a bareword operator.
 * 
 * $set (&quot;Foo&quot; -&gt; &quot;bar&quot;)
 *
 * Targets an RValue of (String, Any)* to be converted to a  DBObject  
 *
 * @author Brendan W. McAdams &lt;brendan@10gen.com&gt;
 * @see http://www.mongodb.org/display/DOCS/Updating#Updating-%24set
 */</span>
<span class="keyword">trait</span> <a title="trait SetOp extends java.lang.Object with com.mongodb.casbah.query.BarewordQueryOperator with ScalaObject" id="9371">SetOp</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#9369" title="com.mongodb.casbah.query.BarewordQueryOperator">BarewordQueryOperator</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="=&gt; ((String, Any)*) =&gt; com.mongodb.casbah.commons.Imports.DBObject" id="16652">$set</a> = <a href="#10057" title="[A](oper: String)(fields: (String, A)*)com.mongodb.casbah.commons.Imports.DBObject">apply</a><span title="(oper: String)(fields: (String, Any)*)com.mongodb.casbah.commons.Imports.DBObject" class="delimiter">[</span><span title="Any">Any</span><span class="delimiter">]</span><a href="#16698" title="(String, Any)*" class="delimiter">(</a><span title="java.lang.String(&quot;$set&quot;)" class="string">&quot;$set&quot;</span><span class="delimiter">)</span>_
<span class="delimiter">}</span>

<span class="comment">/**
 * Trait to provide the $unset (UnSet) UnSet method as a bareword operator..
 *
 * $unset (&quot;foo&quot;)
 *
 * Targets an RValue of String*, where String are field names to be converted to a  DBObject  
 *
 * @author Brendan W. McAdams &lt;brendan@10gen.com&gt;
 * @see http://www.mongodb.org/display/DOCS/Updating#Updating-%24unset
 */</span>
<span class="keyword">trait</span> <a title="trait UnsetOp extends java.lang.Object with com.mongodb.casbah.query.BarewordQueryOperator with ScalaObject" id="9372">UnsetOp</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#9369" title="com.mongodb.casbah.query.BarewordQueryOperator">BarewordQueryOperator</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(args: String*)com.mongodb.casbah.commons.Imports.DBObject" id="16655">$unset</a><span class="delimiter">(</span><a title="String*" id="16704">args</a>: <span title="String*">String</span>*<span class="delimiter">)</span> = <a href="#10057" title="(oper: String)(fields: (String, Int)*)com.mongodb.casbah.commons.Imports.DBObject">apply</a><span class="delimiter">(</span><span title="java.lang.String(&quot;$unset&quot;)" class="string">&quot;$unset&quot;</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#16704" title="String*">args</a>.<span title="(f: (String) =&gt; (String, Int))(implicit bf: scala.collection.generic.CanBuildFrom[Seq[String],(String, Int),Seq[(String, Int)]])Seq[(String, Int)]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,(String, Int),Seq[(String, Int)]]" class="delimiter">(</span><a href="#16724" title="(y: Int)(String, Int)">_</a> -&gt; <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>: _*<span class="delimiter">)</span>
<span class="delimiter">}</span>


<span class="comment">/** 
 * Trait to provide the $inc (inc) method as a bareword operator..
 *
 *   $inc (&quot;foo&quot; -&gt; 5)
 *
 * Targets an RValue of (String, ValidNumericType)* to be converted to a  DBObject  
 *
 * Due to a quirk in the way I implemented type detection this fails if you mix ValidNumericType types.  E.g. floats work, but not mixing floats and ints.
 * This can be easily circumvented if you want 'ints' with floats by making your ints floats with .0:
 * 
 *   $inc (&quot;foo&quot; -&gt; 5.0, &quot;bar&quot; -&gt; 1.6)
 *
 * @author Brendan W. McAdams &lt;brendan@10gen.com&gt;
 * @since 1.0
 * @see http://www.mongodb.org/display/DOCS/Updating#Updating-%24inc
 */</span>
<span class="keyword">trait</span> <a title="trait IncOp extends java.lang.Object with com.mongodb.casbah.query.BarewordQueryOperator with ScalaObject" id="9373">IncOp</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#9369" title="com.mongodb.casbah.query.BarewordQueryOperator">BarewordQueryOperator</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="[T](args: (String, T)*)(implicit evidence$1: com.mongodb.casbah.query.ValidNumericType[T])com.mongodb.casbah.commons.Imports.DBObject" id="16821">$inc</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="16659">T</a> : ValidNumericType<span class="delimiter">]</span><span class="delimiter">(</span><a title="(String, T)*" id="16820">args</a>: <span title="(String, T)*" class="delimiter">(</span>String, T<span class="delimiter">)</span>*<span class="delimiter">)</span> = <a href="#10057" title="[A](oper: String)(fields: (String, A)*)com.mongodb.casbah.commons.Imports.DBObject">apply</a><span title="(oper: String)(fields: (String, T)*)com.mongodb.casbah.commons.Imports.DBObject" class="delimiter">[</span><a href="#16659" title="T">T</a><span class="delimiter">]</span><span class="delimiter">(</span><span title="java.lang.String(&quot;$inc&quot;)" class="string">&quot;$inc&quot;</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#16820" title="(String, T)*">args</a>: _*<span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait ArrayOps extends java.lang.Object with com.mongodb.casbah.query.PushOp with com.mongodb.casbah.query.PushAllOp with com.mongodb.casbah.query.AddToSetOp with com.mongodb.casbah.query.PopOp with com.mongodb.casbah.query.PullOp with com.mongodb.casbah.query.PullAllOp" id="9374">ArrayOps</a> <span class="keyword">extends</span> <a href="#9375" title="com.mongodb.casbah.query.PushOp">PushOp</a>
                  <span class="keyword">with</span> <a href="#9376" title="com.mongodb.casbah.query.PushAllOp">PushAllOp</a>
                  <span class="keyword">with</span> <a href="#9377" title="com.mongodb.casbah.query.AddToSetOp">AddToSetOp</a>
                  <span class="keyword">with</span> <a href="#9378" title="com.mongodb.casbah.query.PopOp">PopOp</a>
                  <span class="keyword">with</span> <a href="#9379" title="com.mongodb.casbah.query.PullOp">PullOp</a>
                  <span class="keyword">with</span> <a href="#9380" title="com.mongodb.casbah.query.PullAllOp">PullAllOp</a>

<span class="comment">/*
 * Trait to provide the $push (push) method as a bareword operator.
 *
 * Targets an RValue of (String, Any)* to be converted to a  DBObject  
 *
 * If Field exists but is not an array an error will occur
 * 
 * @author Brendan W. McAdams &lt;brendan@10gen.com&gt;
 * @see http://www.mongodb.org/display/DOCS/Updating#Updating-%24push
 * 
 */</span>
<span class="keyword">trait</span> <a title="trait PushOp extends java.lang.Object with com.mongodb.casbah.query.BarewordQueryOperator with ScalaObject" id="9375">PushOp</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#9369" title="com.mongodb.casbah.query.BarewordQueryOperator">BarewordQueryOperator</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="=&gt; ((String, Any)*) =&gt; com.mongodb.casbah.commons.Imports.DBObject" id="16665">$push</a> = <a href="#10057" title="[A](oper: String)(fields: (String, A)*)com.mongodb.casbah.commons.Imports.DBObject">apply</a><span title="(oper: String)(fields: (String, Any)*)com.mongodb.casbah.commons.Imports.DBObject" class="delimiter">[</span><span title="Any">Any</span><span class="delimiter">]</span><a href="#16838" title="(String, Any)*" class="delimiter">(</a><span title="java.lang.String(&quot;$push&quot;)" class="string">&quot;$push&quot;</span><span class="delimiter">)</span>_
<span class="delimiter">}</span>

<span class="comment">/*
 * Trait to provide the $pushAll (pushAll) method as a bareword operator..
 *
 * Targets an RValue of (String, Array[Any])* to be converted to a  DBObject  
 *
 * RValue MUST Be an array - otherwise use push.
 *
 *
 * @author Brendan W. McAdams &lt;brendan@10gen.com&gt;
 * @see http://www.mongodb.org/display/DOCS/Updating#Updating-%24pushAll
 */</span>
<span class="keyword">trait</span> <a title="trait PushAllOp extends java.lang.Object with com.mongodb.casbah.query.BarewordQueryOperator with ScalaObject" id="9376">PushAllOp</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#9369" title="com.mongodb.casbah.query.BarewordQueryOperator">BarewordQueryOperator</a> <span class="delimiter">{</span>
   <span class="keyword">def</span> <a title="[A](args: (String, A)*)(implicit evidence$2: Manifest[A])com.mongodb.casbah.commons.Imports.DBObject" id="16845">$pushAll</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="16669">A</a> &lt;: Any : Manifest<span class="delimiter">]</span><span class="delimiter">(</span><a title="(String, A)*" id="16844">args</a>: <span title="(String, A)*" class="delimiter">(</span>String, A<span class="delimiter">)</span>*<span class="delimiter">)</span>: <span title="com.mongodb.casbah.commons.Imports.DBObject">DBObject</span> = 
    <span title="com.mongodb.casbah.commons.Imports.DBObject" class="keyword">if</span> <span class="delimiter">(</span><span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#16845" title="(that: scala.reflect.ClassManifest[_])Boolean" class="delimiter">[</a><a href="#16669" title="A">A</a><span class="delimiter">]</span> &lt;:&lt; <span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><span title="(implicit m: Manifest[Iterable[_]])Manifest[Iterable[_]]" class="delimiter">[</span><span title="Iterable[_]">Iterable</span><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> 
      <a href="#10057" title="(oper: String)(fields: (String, Iterable[Any])*)com.mongodb.casbah.commons.Imports.DBObject">apply</a><span class="delimiter">(</span><span title="java.lang.String(&quot;$pushAll&quot;)" class="string">&quot;$pushAll&quot;</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#16844" title="(String, A)*">args</a>.<span title="(f: ((String, A)) =&gt; (java.lang.String, Iterable[Any]))(implicit bf: scala.collection.generic.CanBuildFrom[Seq[(String, A)],(java.lang.String, Iterable[Any]),Seq[(java.lang.String, Iterable[Any])]])Seq[(java.lang.String, Iterable[Any])]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,(java.lang.String, Iterable[Any]),Seq[(java.lang.String, Iterable[Any])]]" class="delimiter">(</span><a title="(String, A)" id="18492">z</a> =&gt; <a href="#18492" title="(String, A)">z</a>.<span title="(y: Iterable[_$2])(String, Iterable[_$2])">_1</span> -&gt; <a href="#18492" title="(String, A)">z</a>.<span title="=&gt; A">_2</span>.<span title="[T0]T0">asInstanceOf</span><span title="Iterable[_$2]" class="delimiter">[</span><span title="Iterable[_]">Iterable</span><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>:_*<span class="delimiter">)</span>
    <span class="keyword">else</span> <span title="com.mongodb.casbah.commons.Imports.DBObject" class="keyword">if</span> <span class="delimiter">(</span><span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#16845" title="(that: scala.reflect.ClassManifest[_])Boolean" class="delimiter">[</a><a href="#16669" title="A">A</a><span class="delimiter">]</span> &lt;:&lt; <span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><span title="(implicit m: Manifest[Product])Manifest[Product]" class="delimiter">[</span><span title="Product">Product</span><span class="delimiter">]</span><span class="delimiter">)</span> 
      <a href="#10057" title="(oper: String)(fields: (String, Iterable[Any])*)com.mongodb.casbah.commons.Imports.DBObject">apply</a><span class="delimiter">(</span><span title="java.lang.String(&quot;$pushAll&quot;)" class="string">&quot;$pushAll&quot;</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#16844" title="(String, A)*">args</a>.<span title="(f: ((String, A)) =&gt; (String, Iterable[Any]))(implicit bf: scala.collection.generic.CanBuildFrom[Seq[(String, A)],(String, Iterable[Any]),Seq[(String, Iterable[Any])]])Seq[(String, Iterable[Any])]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,(String, Iterable[Any]),Seq[(String, Iterable[Any])]]" class="delimiter">(</span><a title="(String, A)" id="18626">z</a> =&gt; <a href="#18626" title="(String, A)">z</a>.<span title="(y: Iterable[Any])(String, Iterable[Any])">_1</span> -&gt; <a href="#18626" title="(String, A)">z</a>.<span title="=&gt; A">_2</span>.<span title="[T0]T0">asInstanceOf</span><span title="Product" class="delimiter">[</span><span title="Product">Product</span><span class="delimiter">]</span>.<span title="=&gt; Iterator[Any]">productIterator</span>.<span title="=&gt; Iterable[Any]">toIterable</span><span class="delimiter">)</span>: _*<span class="delimiter">)</span>
    <span class="keyword">else</span> <span title="com.mongodb.casbah.commons.Imports.DBObject" class="keyword">if</span> <span class="delimiter">(</span><span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#16845" title="(implicit m: Manifest[A])Manifest[A]" class="delimiter">[</a><a href="#16669" title="A">A</a><span class="delimiter">]</span>.<span title="=&gt; Class[_]">erasure</span>.<span title="()Boolean">isArray</span><span class="delimiter">)</span> 
      <a href="#10057" title="(oper: String)(fields: (String, Iterable[Any])*)com.mongodb.casbah.commons.Imports.DBObject">apply</a><span class="delimiter">(</span><span title="java.lang.String(&quot;$pushAll&quot;)" class="string">&quot;$pushAll&quot;</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#16844" title="(String, A)*">args</a>.<span title="(f: ((String, A)) =&gt; (java.lang.String, Iterable[Any]))(implicit bf: scala.collection.generic.CanBuildFrom[Seq[(String, A)],(java.lang.String, Iterable[Any]),Seq[(java.lang.String, Iterable[Any])]])Seq[(java.lang.String, Iterable[Any])]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,(java.lang.String, Iterable[Any]),Seq[(java.lang.String, Iterable[Any])]]" class="delimiter">(</span><a title="(String, A)" id="18730">z</a> =&gt; <a href="#18730" title="(String, A)">z</a>.<span title="(y: Iterable[_$3])(String, Iterable[_$3])">_1</span> -&gt; <a href="#18730" title="(String, A)">z</a>.<span title="=&gt; A">_2</span>.<span title="[T0]T0">asInstanceOf</span><span title="(xs: Array[_$3])scala.collection.mutable.ArrayOps[_$3]" class="delimiter">[</span><span title="Array[_]">Array</span><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">]</span>.<span title="=&gt; Iterable[_$3]">toIterable</span><span class="delimiter">)</span>: _*<span class="delimiter">)</span>
    <span class="keyword">else</span> 
      <span title="Nothing" class="keyword">throw</span> <span title="(x$1: java.lang.String)java.lang.IllegalArgumentException" class="keyword">new</span> <span title="java.lang.IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;$pushAll may only be invoked with a (String, A) where String is the field name and A is an Iterable or Product/Tuple of values (got %s).&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#16845" title="(implicit m: Manifest[A])Manifest[A]" class="delimiter">[</a><a href="#16669" title="A">A</a><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="comment">/*
 * Trait to provide the $addToSet (addToSet) method as a bareword operator..
 *
 * Targets an RValue of (String, Any)* to be converted to a  DBObject  
 *
 * Can also combined with the $each operator for adding many values:
 *
 *   scala&gt; $addToSet (&quot;foo&quot;) $each (5, 10, 15, &quot;20&quot;))
 *  res6: com.mongodb.casbah.commons.Imports.DBObject = { &quot;$addToSet&quot; : { &quot;foo&quot; : { &quot;$each&quot; : [ 5 , 10 , 15 , &quot;20&quot;]}}}
 *
 * @author Brendan W. McAdams &lt;brendan@10gen.com&gt;
 * @see http://www.mongodb.org/display/DOCS/Updating#Updating-%24addToSet
 */</span>
<span class="keyword">trait</span> <a title="trait AddToSetOp extends java.lang.Object with com.mongodb.casbah.query.BarewordQueryOperator with ScalaObject" id="9377">AddToSetOp</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#9369" title="com.mongodb.casbah.query.BarewordQueryOperator">BarewordQueryOperator</a> <span class="delimiter">{</span>

  <span class="keyword">def</span> <a title="[T](arg: T)(implicit evidence$3: (T) =&gt; com.mongodb.casbah.commons.Imports.DBObject)com.mongodb.casbah.commons.Imports.DBObject" id="19202">$addToSet</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="16673">T</a> &lt;% DBObject<span class="delimiter">]</span><span class="delimiter">(</span><a title="T" id="19201">arg</a>: <a href="#16673" title="T">T</a><span class="delimiter">)</span> = 
    <span title="(elems: (java.lang.String, T)*)com.mongodb.casbah.commons.Imports.DBObject">MongoDBObject</span><span class="delimiter">(</span><span title="(y: T)(java.lang.String, T)" class="string">&quot;$addToSet&quot;</span> -&gt; <a href="#19201" title="T">arg</a><span class="delimiter">)</span>

  <span class="comment">/* $each-able */</span>
  <span class="keyword">def</span> <a title="(field: String)java.lang.Object{def $each(target: Array[Any]): com.mongodb.casbah.commons.Imports.DBObject; def $each(target: Any*): com.mongodb.casbah.commons.Imports.DBObject}" id="16674">$addToSet</a><span class="delimiter">(</span><a title="String" id="19235">field</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="comment">/**
     * Special query operator only available on the right-hand side of an 
     * $addToSet which takes a list of values.
     *
     * Slightly hacky to prevent it from returning unless completed with a $each
     *
     * THIS WILL NOT WORK IN MONGOD ANYWHERE BUT INSIDE AN ADDTOSET 
     *
     * @author Brendan W. McAdams &lt;brendan@10gen.com&gt;
     * @since 2.0
     * @see http://www.mongodb.org/display/DOCS/Updating#Updating-%24addToSet
     */</span>
    <a href="#19238" title="java.lang.Object{protected def op(target: Any): com.mongodb.casbah.commons.Imports.DBObject; def $each(target: Array[Any]): com.mongodb.casbah.commons.Imports.DBObject; def $each(target: Any*): com.mongodb.casbah.commons.Imports.DBObject}" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object" id="19238" class="delimiter">{</a>
      <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(target: Any)com.mongodb.casbah.commons.Imports.DBObject" id="19240">op</a><span class="delimiter">(</span><a title="Any" id="19243">target</a>: <span title="Any">Any</span><span class="delimiter">)</span> = 
        <span title="(elems: (java.lang.String, com.mongodb.casbah.commons.Imports.DBObject)*)com.mongodb.casbah.commons.Imports.DBObject">MongoDBObject</span><span class="delimiter">(</span><span title="(y: com.mongodb.casbah.commons.Imports.DBObject)(java.lang.String, com.mongodb.casbah.commons.Imports.DBObject)" class="string">&quot;$addToSet&quot;</span> -&gt; <span title="(elems: (String, com.mongodb.casbah.commons.Imports.DBObject)*)com.mongodb.casbah.commons.Imports.DBObject">MongoDBObject</span><span class="delimiter">(</span><a href="#19235" title="(y: com.mongodb.casbah.commons.Imports.DBObject)(String, com.mongodb.casbah.commons.Imports.DBObject)">field</a> -&gt; <span title="(elems: (java.lang.String, Any)*)com.mongodb.casbah.commons.Imports.DBObject">MongoDBObject</span><span class="delimiter">(</span><span title="(y: Any)(java.lang.String, Any)" class="string">&quot;$each&quot;</span> -&gt; <a href="#19243" title="Any">target</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> 

      <span class="keyword">def</span> <a title="(target: Array[Any])com.mongodb.casbah.commons.Imports.DBObject" id="19241">$each</a><span class="delimiter">(</span><a title="Array[Any]" id="19328">target</a>: <span title="Array[Any]">Array</span><span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#19240" title="(target: Any)com.mongodb.casbah.commons.Imports.DBObject">op</a><span class="delimiter">(</span><a href="#19328" title="(xs: Array[Any])scala.collection.mutable.ArrayOps[Any]">target</a>.<span title="(underlying: Seq[Any])scalaj.collection.s2j.RichSeq[Any]">toList</span>.<span title="(implicit c: scalaj.collection.s2j.Coercible[Any,Any])java.util.List[Any]">asJava</span><span class="delimiter">)</span>
      <span class="keyword">def</span> <a title="(target: Any*)com.mongodb.casbah.commons.Imports.DBObject" id="19242">$each</a><span class="delimiter">(</span><a title="Any*" id="19758">target</a>: <span title="Any*">Any</span>*<span class="delimiter">)</span> = 
        <span title="com.mongodb.casbah.commons.Imports.DBObject" class="keyword">if</span> <span class="delimiter">(</span><a href="#19758" title="Any*">target</a>.<span title="(x$1: Int)Boolean">size</span> &gt; <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
          <a href="#19240" title="(target: Any)com.mongodb.casbah.commons.Imports.DBObject">op</a><span class="delimiter">(</span><a href="#19758" title="Any*">target</a>.<span title="(underlying: Seq[Any])scalaj.collection.s2j.RichSeq[Any]">toList</span>.<span title="(implicit c: scalaj.collection.s2j.Coercible[Any,Any])java.util.List[Any]">asJava</span><span class="delimiter">)</span> 
        <span class="keyword">else</span> <span title="com.mongodb.casbah.commons.Imports.DBObject" class="keyword">if</span> <span class="delimiter">(</span><span title="(x$1: Boolean)Boolean">!</span><a href="#19758" title="(idx: Int)Any">target</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<span title="[T0]Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><span title="Iterable[_]">Iterable</span><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">]</span> &amp;&amp;
                 <span title="=&gt; Boolean">!</span><a href="#19758" title="(idx: Int)Any">target</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<span title="[T0]Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><span title="Array[_]">Array</span><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>
          <a href="#19240" title="(target: Any)com.mongodb.casbah.commons.Imports.DBObject">op</a><span class="delimiter">(</span><span title="(xs: Any*)List[Any]">List</span><span class="delimiter">(</span><a href="#19758" title="(idx: Int)Any">target</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">else</span> <a href="#19240" title="(target: Any)com.mongodb.casbah.commons.Imports.DBObject">op</a><span class="delimiter">(</span><a href="#19758" title="(idx: Int)Any">target</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; ((String, Any)*) =&gt; com.mongodb.casbah.commons.Imports.DBObject" id="16675">$addToSet</a> = <a href="#10057" title="[A](oper: String)(fields: (String, A)*)com.mongodb.casbah.commons.Imports.DBObject">apply</a><span title="(oper: String)(fields: (String, Any)*)com.mongodb.casbah.commons.Imports.DBObject" class="delimiter">[</span><span title="Any">Any</span><span class="delimiter">]</span><a href="#19918" title="(String, Any)*" class="delimiter">(</a><span title="java.lang.String(&quot;$addToSet&quot;)" class="string">&quot;$addToSet&quot;</span><span class="delimiter">)</span>_
<span class="delimiter">}</span>


<span class="comment">/*
 * Trait to provide the $pop (pop) method as a bareword operator..
 *
 *
 * TODO - Restrict to a 'Whole Number' type
 * 
 * If Field exists but is not an array an error will occurr.
 *
 * @author Brendan W. McAdams &lt;brendan@10gen.com&gt;
 * @see http://www.mongodb.org/display/DOCS/Updating#Updating-%24pop
 */</span>
<span class="keyword">trait</span> <a title="trait PopOp extends java.lang.Object with com.mongodb.casbah.query.BarewordQueryOperator with ScalaObject" id="9378">PopOp</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#9369" title="com.mongodb.casbah.query.BarewordQueryOperator">BarewordQueryOperator</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="[T](args: (String, T)*)(implicit evidence$4: com.mongodb.casbah.query.ValidNumericType[T])com.mongodb.casbah.commons.Imports.DBObject" id="19925">$pop</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="16679">T</a> : ValidNumericType<span class="delimiter">]</span><span class="delimiter">(</span><a title="(String, T)*" id="19924">args</a>: <span title="(String, T)*" class="delimiter">(</span>String, T<span class="delimiter">)</span>*<span class="delimiter">)</span> = <a href="#10057" title="[A](oper: String)(fields: (String, A)*)com.mongodb.casbah.commons.Imports.DBObject">apply</a><span title="(oper: String)(fields: (String, T)*)com.mongodb.casbah.commons.Imports.DBObject" class="delimiter">[</span><a href="#16679" title="T">T</a><span class="delimiter">]</span><span class="delimiter">(</span><span title="java.lang.String(&quot;$pop&quot;)" class="string">&quot;$pop&quot;</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#19924" title="(String, T)*">args</a>: _*<span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="comment">/*
 * Trait to provide the $pull (pull) method as a bareword operator..
 *
 * Targets an RValue of (String, Any)* to be converted to a  DBObject  
 *
 * If Field exists but is not an array an error will occurr.
 * 
 * Pull is special as defined in the docs and needs to allow operators on fields.
 * 
 * @author Brendan W. McAdams &lt;brendan@10gen.com&gt;
 * @see http://www.mongodb.org/display/DOCS/Updating#Updating-%24pull
 */</span>
<span class="keyword">trait</span> <a title="trait PullOp extends java.lang.Object with com.mongodb.casbah.query.BarewordQueryOperator with ScalaObject" id="9379">PullOp</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#9369" title="com.mongodb.casbah.query.BarewordQueryOperator">BarewordQueryOperator</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="=&gt; ((String, Any)*) =&gt; com.mongodb.casbah.commons.Imports.DBObject" id="16681">$pull</a> = <a href="#10057" title="[A](oper: String)(fields: (String, A)*)com.mongodb.casbah.commons.Imports.DBObject">apply</a><span title="(oper: String)(fields: (String, Any)*)com.mongodb.casbah.commons.Imports.DBObject" class="delimiter">[</span><span title="Any">Any</span><span class="delimiter">]</span><a href="#19941" title="(String, Any)*" class="delimiter">(</a><span title="java.lang.String(&quot;$pull&quot;)" class="string">&quot;$pull&quot;</span><span class="delimiter">)</span>_

  <span class="comment">/** ValueTest enabled version */</span>
  <span class="keyword">def</span> <a title="(inner: =&gt; com.mongodb.casbah.commons.Imports.DBObject)com.mongodb.casbah.commons.Imports.DBObject" id="16682">$pull</a><span class="delimiter">(</span><a title="=&gt; com.mongodb.casbah.commons.Imports.DBObject" id="19945">inner</a>: =&gt; DBObject<span class="delimiter">)</span> = 
    <span title="(elems: (java.lang.String, com.mongodb.casbah.commons.Imports.DBObject)*)com.mongodb.casbah.commons.Imports.DBObject">MongoDBObject</span><span class="delimiter">(</span><span title="(y: com.mongodb.casbah.commons.Imports.DBObject)(java.lang.String, com.mongodb.casbah.commons.Imports.DBObject)" class="string">&quot;$pull&quot;</span> -&gt; <a href="#19945" title="=&gt; com.mongodb.casbah.commons.Imports.DBObject">inner</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(inner: com.mongodb.casbah.commons.Imports.DBObject)com.mongodb.casbah.commons.Imports.DBObject" id="16683">$pull</a><span class="delimiter">(</span><a title="com.mongodb.casbah.commons.Imports.DBObject" id="19976">inner</a>: <span title="com.mongodb.casbah.commons.Imports.DBObject">DBObject</span><span class="delimiter">)</span> = 
    <span title="(elems: (java.lang.String, com.mongodb.casbah.commons.Imports.DBObject)*)com.mongodb.casbah.commons.Imports.DBObject">MongoDBObject</span><span class="delimiter">(</span><span title="(y: com.mongodb.casbah.commons.Imports.DBObject)(java.lang.String, com.mongodb.casbah.commons.Imports.DBObject)" class="string">&quot;$pull&quot;</span> -&gt; <a href="#19976" title="com.mongodb.casbah.commons.Imports.DBObject">inner</a><span class="delimiter">)</span>

<span class="delimiter">}</span>

<span class="comment">/*
 * Trait to provide the $pullAll (pullAll) method as a bareword operator..
 *
 * Targets an RValue of (String, Array[Any])* to be converted to a  DBObject  
 *
 * RValue MUST Be an array - otherwise use pull.
 *
 *
 * @author Brendan W. McAdams &lt;brendan@10gen.com&gt;
 * @see http://www.mongodb.org/display/DOCS/Updating#Updating-%24pullAll
 */</span>
<span class="keyword">trait</span> <a title="trait PullAllOp extends java.lang.Object with com.mongodb.casbah.query.BarewordQueryOperator with ScalaObject" id="9380">PullAllOp</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#9369" title="com.mongodb.casbah.query.BarewordQueryOperator">BarewordQueryOperator</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="[A](args: (String, A)*)(implicit evidence$5: Manifest[A])com.mongodb.casbah.commons.Imports.DBObject" id="20010">$pullAll</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="16687">A</a> &lt;: Any : Manifest<span class="delimiter">]</span><span class="delimiter">(</span><a title="(String, A)*" id="20009">args</a>: <span title="(String, A)*" class="delimiter">(</span>String, A<span class="delimiter">)</span>*<span class="delimiter">)</span>: <span title="com.mongodb.casbah.commons.Imports.DBObject">DBObject</span> = 
    <span title="com.mongodb.casbah.commons.Imports.DBObject" class="keyword">if</span> <span class="delimiter">(</span><span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#20010" title="(that: scala.reflect.ClassManifest[_])Boolean" class="delimiter">[</a><a href="#16687" title="A">A</a><span class="delimiter">]</span> &lt;:&lt; <span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><span title="(implicit m: Manifest[Iterable[_]])Manifest[Iterable[_]]" class="delimiter">[</span><span title="Iterable[_]">Iterable</span><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> 
      <a href="#10057" title="(oper: String)(fields: (String, Iterable[Any])*)com.mongodb.casbah.commons.Imports.DBObject">apply</a><span class="delimiter">(</span><span title="java.lang.String(&quot;$pullAll&quot;)" class="string">&quot;$pullAll&quot;</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#20009" title="(String, A)*">args</a>.<span title="(f: ((String, A)) =&gt; (java.lang.String, Iterable[Any]))(implicit bf: scala.collection.generic.CanBuildFrom[Seq[(String, A)],(java.lang.String, Iterable[Any]),Seq[(java.lang.String, Iterable[Any])]])Seq[(java.lang.String, Iterable[Any])]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,(java.lang.String, Iterable[Any]),Seq[(java.lang.String, Iterable[Any])]]" class="delimiter">(</span><a title="(String, A)" id="20078">z</a> =&gt; <a href="#20078" title="(String, A)">z</a>.<span title="(y: Iterable[_$7])(String, Iterable[_$7])">_1</span> -&gt; <a href="#20078" title="(String, A)">z</a>.<span title="=&gt; A">_2</span>.<span title="[T0]T0">asInstanceOf</span><span title="Iterable[_$7]" class="delimiter">[</span><span title="Iterable[_]">Iterable</span><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>:_*<span class="delimiter">)</span>
    <span class="keyword">else</span> <span title="com.mongodb.casbah.commons.Imports.DBObject" class="keyword">if</span> <span class="delimiter">(</span><span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#20010" title="(that: scala.reflect.ClassManifest[_])Boolean" class="delimiter">[</a><a href="#16687" title="A">A</a><span class="delimiter">]</span> &lt;:&lt; <span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><span title="(implicit m: Manifest[Product])Manifest[Product]" class="delimiter">[</span><span title="Product">Product</span><span class="delimiter">]</span><span class="delimiter">)</span> 
      <a href="#10057" title="(oper: String)(fields: (String, Iterable[Any])*)com.mongodb.casbah.commons.Imports.DBObject">apply</a><span class="delimiter">(</span><span title="java.lang.String(&quot;$pullAll&quot;)" class="string">&quot;$pullAll&quot;</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#20009" title="(String, A)*">args</a>.<span title="(f: ((String, A)) =&gt; (String, Iterable[Any]))(implicit bf: scala.collection.generic.CanBuildFrom[Seq[(String, A)],(String, Iterable[Any]),Seq[(String, Iterable[Any])]])Seq[(String, Iterable[Any])]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,(String, Iterable[Any]),Seq[(String, Iterable[Any])]]" class="delimiter">(</span><a title="(String, A)" id="20212">z</a> =&gt; <a href="#20212" title="(String, A)">z</a>.<span title="(y: Iterable[Any])(String, Iterable[Any])">_1</span> -&gt; <a href="#20212" title="(String, A)">z</a>.<span title="=&gt; A">_2</span>.<span title="[T0]T0">asInstanceOf</span><span title="Product" class="delimiter">[</span><span title="Product">Product</span><span class="delimiter">]</span>.<span title="=&gt; Iterator[Any]">productIterator</span>.<span title="=&gt; Iterable[Any]">toIterable</span><span class="delimiter">)</span>: _*<span class="delimiter">)</span>
    <span class="keyword">else</span> <span title="com.mongodb.casbah.commons.Imports.DBObject" class="keyword">if</span> <span class="delimiter">(</span><span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#20010" title="(implicit m: Manifest[A])Manifest[A]" class="delimiter">[</a><a href="#16687" title="A">A</a><span class="delimiter">]</span>.<span title="=&gt; Class[_]">erasure</span>.<span title="()Boolean">isArray</span><span class="delimiter">)</span> 
      <a href="#10057" title="(oper: String)(fields: (String, Iterable[Any])*)com.mongodb.casbah.commons.Imports.DBObject">apply</a><span class="delimiter">(</span><span title="java.lang.String(&quot;$pullAll&quot;)" class="string">&quot;$pullAll&quot;</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#20009" title="(String, A)*">args</a>.<span title="(f: ((String, A)) =&gt; (java.lang.String, Iterable[Any]))(implicit bf: scala.collection.generic.CanBuildFrom[Seq[(String, A)],(java.lang.String, Iterable[Any]),Seq[(java.lang.String, Iterable[Any])]])Seq[(java.lang.String, Iterable[Any])]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,(java.lang.String, Iterable[Any]),Seq[(java.lang.String, Iterable[Any])]]" class="delimiter">(</span><a title="(String, A)" id="20312">z</a> =&gt; <a href="#20312" title="(String, A)">z</a>.<span title="(y: Iterable[_$8])(String, Iterable[_$8])">_1</span> -&gt; <a href="#20312" title="(String, A)">z</a>.<span title="=&gt; A">_2</span>.<span title="[T0]T0">asInstanceOf</span><span title="(xs: Array[_$8])scala.collection.mutable.ArrayOps[_$8]" class="delimiter">[</span><span title="Array[_]">Array</span><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">]</span>.<span title="=&gt; Iterable[_$8]">toIterable</span><span class="delimiter">)</span>: _*<span class="delimiter">)</span>
    <span class="keyword">else</span> 
      <span title="Nothing" class="keyword">throw</span> <span title="(x$1: java.lang.String)java.lang.IllegalArgumentException" class="keyword">new</span> <span title="java.lang.IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;$pullAll may only be invoked with a (String, A) where String is the field name and A is an Iterable or Product/Tuple of values (got %s).&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#20010" title="(implicit m: Manifest[A])Manifest[A]" class="delimiter">[</a><a href="#16687" title="A">A</a><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * Trait to provide the $or method as a bareword operator.
 *
 * $or (&quot;Foo&quot; -&gt; &quot;bar&quot;)
 *
 * Targets an RValue of (String, Any)* to be converted to a  DBObject  
 *
 * TODO - Test that rvalue ends up being an array e.g.:
 * 
 *   scala&gt; $or (&quot;foo&quot; -&gt; &quot;bar&quot;, &quot;X&quot; -&gt; 5)           
 *   res1: com.mongodb.casbah.commons.Imports.DBObject = { &quot;$or&quot; : [ { &quot;foo&quot; : &quot;bar&quot; , &quot;X&quot; : 5}]}
 *  
 * 
 * @author Brendan W. McAdams &lt;brendan@10gen.com&gt;
 * @since 2.0
 * @see http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-%24or
 */</span>

<span class="keyword">trait</span> <a title="trait OrOp extends java.lang.Object with com.mongodb.casbah.query.BarewordQueryOperator with ScalaObject" id="9381">OrOp</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#9369" title="com.mongodb.casbah.query.BarewordQueryOperator">BarewordQueryOperator</a> <span class="delimiter">{</span>

  <span class="keyword">def</span> <a title="(fields: (String, Any)*)com.mongodb.casbah.commons.Imports.DBObject" id="16661">$or</a><span class="delimiter">(</span><a title="(String, Any)*" id="20663">fields</a>: <span title="(String, Any)*" class="delimiter">(</span>String, Any<span class="delimiter">)</span>*<span class="delimiter">)</span> = <span class="delimiter">{</span> 
    <span class="keyword">val</span> <a title="com.mongodb.casbah.commons.MongoDBListBuilder" id="20666">bldr</a> = <span title="=&gt; com.mongodb.casbah.commons.MongoDBList.type">MongoDBList</span>.<span title="com.mongodb.casbah.commons.MongoDBListBuilder">newBuilder</span>
    <span class="keyword">for</span> <span class="delimiter">(</span><span class="delimiter">(</span><a title="String" id="20718">k</a>, <a title="Any" id="20719">v</a><span class="delimiter">)</span> &lt;- <a href="#20663" title="(f: ((String, Any)) =&gt; com.mongodb.casbah.commons.MongoDBListBuilder)Unit">fields</a><span class="delimiter">)</span> <a href="#20666" title="(x: Any)bldr.type">bldr</a> += <span title="(elems: (String, Any)*)com.mongodb.casbah.commons.Imports.DBObject">MongoDBObject</span><span class="delimiter">(</span><a href="#20718" title="(y: Any)(String, Any)">k</a> -&gt; <a href="#20719" title="Any">v</a><span class="delimiter">)</span>
    <span title="(elems: (java.lang.String, com.mongodb.casbah.commons.Imports.DBObject)*)com.mongodb.casbah.commons.Imports.DBObject">MongoDBObject</span><span class="delimiter">(</span><span title="(y: com.mongodb.casbah.commons.Imports.DBObject)(java.lang.String, com.mongodb.casbah.commons.Imports.DBObject)" class="string">&quot;$or&quot;</span> -&gt; <a href="#20666" title="com.mongodb.casbah.commons.MongoDBListBuilder">bldr</a>.<span title="implicit com.mongodb.casbah.commons.Implicits.wrapDBObj : (in: com.mongodb.DBObject)com.mongodb.casbah.commons.MongoDBObject">result</span>.<span title="=&gt; com.mongodb.casbah.commons.Imports.DBObject">asDBObject</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

<span class="comment">/** 
 * Trait to provide the $rename (Rename field) as a bareword operator
 *
 * Targets (takes a right-hand value of) a DBObject or a Tuple of (String, String) 
 * 
 * WORKS ONLY IN MONGODB 1.7.2+
 * 
 * @author Brendan W. McAdams &lt;brendan@10gen.com&gt;
 * @since 2.0
 * @see http://www.mongodb.org/display/DOCS/Updating#Updating-%24rename
 *
 */</span>
<span class="keyword">trait</span> <a title="trait RenameOp extends java.lang.Object with com.mongodb.casbah.query.BarewordQueryOperator with ScalaObject" id="9382">RenameOp</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#9369" title="com.mongodb.casbah.query.BarewordQueryOperator">BarewordQueryOperator</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="=&gt; ((String, Any)*) =&gt; com.mongodb.casbah.commons.Imports.DBObject" id="16663">$rename</a> = <a href="#10057" title="[A](oper: String)(fields: (String, A)*)com.mongodb.casbah.commons.Imports.DBObject">apply</a><span title="(oper: String)(fields: (String, Any)*)com.mongodb.casbah.commons.Imports.DBObject" class="delimiter">[</span><span title="Any">Any</span><span class="delimiter">]</span><a href="#20806" title="(String, Any)*" class="delimiter">(</a><span title="java.lang.String(&quot;$rename&quot;)" class="string">&quot;$rename&quot;</span><span class="delimiter">)</span>_
<span class="delimiter">}</span>

<span class="comment">/**
 * Trait to provide the $nor (nor ) method as a bareword operator
 *
 * Nor is a combination of $not and $or with no left anchor
 *
 * Targets an RValue of (String, Array[Any])* to be converted to a  DBObject  
 *
 * @author Brendan W. McAdams &lt;brendan@10gen.com&gt;
 * @since 2.0
 * @see http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-%24nor
 */</span>
<span class="keyword">trait</span> <a title="trait NorOp extends java.lang.Object with com.mongodb.casbah.query.BarewordQueryOperator with ScalaObject" id="9383">NorOp</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#9369" title="com.mongodb.casbah.query.BarewordQueryOperator">BarewordQueryOperator</a> <span class="delimiter">{</span>

  <span class="comment">/** ValueTest enabled version */</span>
  <span class="keyword">def</span> <a title="(inner: =&gt; com.mongodb.casbah.commons.Imports.DBObject)com.mongodb.casbah.commons.Imports.DBObject" id="16689">$nor</a><span class="delimiter">(</span><a title="=&gt; com.mongodb.casbah.commons.Imports.DBObject" id="20812">inner</a>: =&gt; DBObject<span class="delimiter">)</span> = 
    <span title="(elems: (java.lang.String, com.mongodb.casbah.commons.Imports.BasicDBList)*)com.mongodb.casbah.commons.Imports.DBObject">MongoDBObject</span><span class="delimiter">(</span><span title="(y: com.mongodb.casbah.commons.Imports.BasicDBList)(java.lang.String, com.mongodb.casbah.commons.Imports.BasicDBList)" class="string">&quot;$nor&quot;</span> -&gt; <span class="delimiter">(</span><a href="#20812" title="=&gt; com.mongodb.casbah.commons.Imports.DBObject">inner</a> <span title="com.mongodb.casbah.commons.Imports.BasicDBList" class="keyword">match</span> <span class="delimiter">{</span>
      <span title="com.mongodb.casbah.commons.Imports.BasicDBList" class="keyword">case</span> <a title="com.mongodb.casbah.commons.Imports.BasicDBList" id="20839">obj</a>: <span title="com.mongodb.casbah.commons.Imports.BasicDBList">BasicDBList</span> =&gt; <a href="#20839" title="com.mongodb.casbah.commons.Imports.BasicDBList">obj</a>
      <span title="com.mongodb.BasicDBList" class="keyword">case</span> <a title="com.mongodb.DBObject" id="20840">obj</a>: <span title="com.mongodb.casbah.commons.Imports.DBObject">DBObject</span> =&gt; <span title="(elems: com.mongodb.DBObject*)com.mongodb.BasicDBList">MongoDBList</span><span class="delimiter">(</span><a href="#20840" title="com.mongodb.DBObject">obj</a><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>.<span title="[T0]T0">asInstanceOf</span><span title="com.mongodb.casbah.commons.Imports.BasicDBList" class="delimiter">[</span><span title="com.mongodb.casbah.commons.Imports.BasicDBList">BasicDBList</span><span class="delimiter">]</span><span class="delimiter">)</span> 

<span class="delimiter">}</span>

<span class="comment">// vim: set ts=2 sw=2 sts=2 et:</span>

        </pre>
    </body>
</html>